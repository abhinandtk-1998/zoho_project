{% extends 'base.html' %}
{% block content %}
{% load static %}

<!-- Include FullCalendar CSS -->

<script src='https://cdn.jsdelivr.net/npm/fullcalendar@6.1.10/index.global.min.js'></script>
<link rel="stylesheet" href="{% static 'assets/plugins/fullcalendar/css/main.min.css' %}">


<style>
    .container-flex {
        display: flex;
    }

    .section {
        flex: 1;
        padding: 20px;
    }

    #section1 {
        flex: 1; /* Adjusted width */
    }

    #section2 {
        flex: 2; /* Adjusted width */
    }
</style>

<body>
    <div class="body-wrapper">
        <div class="container-fluid container-flex">
            <div style="overflow-x:auto;" class="section" id="section1">
                <div class="table-responsive">
                    <table class="table mt-lg-5 mt-2 rounded" style="background-color: rgb(0, 0, 0);color: white;">
                        <thead>
                            <tr class="border-bottom border-dark">
                                <th scope="col"><b>Month</b></th>
                                <th scope="col"><b>Year</b></th>
                                <th scope="col"><b>Holidays</b></th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for key, row in holiday_table.items %}
                            <tr class="border-bottom border-dark">
                                <td><a href="{% url 'company_holiday_overview' %}?month={{ row.1 }}&year={{ row.2}}">{{ row.1 }}</a></td>
                                <td><a href="{% url 'company_holiday_overview' %}?month={{ row.1 }}&year={{ row.2}}">{{ row.2 }}</a></td>
                                <td><a href="{% url 'company_holiday_overview' %}?month={{ row.1 }}&year={{ row.2}}">{{ row.3 }}</a></td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table> 
                </div>     
            </div>
            
            <div class="section" id="section2">
                <div class="row radius-15">
                    <div id="calendarDiv" class="col"><center><h3><a href="" id="calendarLink" style="padding: 10px 20%;border-top-right-radius: 15px;border-top-left-radius: 15px;">Calendar</a></h3></center></div>
                    <div id="holidayListDiv" class="col"><center><h3><a href="" id="holidayListLink" style="padding: 10px 20%;border-top-right-radius: 15px;border-top-left-radius: 15px;">Overview</a></h3></center></div>
                </div>
                <div class="card radius-15" style="background-color: rgba(0,0,0,0.1);">
                    <div class="ml-auto"><a style="cursor: pointer;" title="Close" href="" ><i class="fa-solid fa-circle-xmark fa-2xl"></i></a></div>
                    <div class="card-body">
                        
                        <div class="row" id="cal">
                            <div class="col" id="calendar"></div>
                        </div>
                        
                        <div class="row" id="cal_list">
                            
                            <div class="table-responsive">
            
                                <br><br>
                                <table class="table ml-3" style="background-color: rgb(0, 0, 0);color: white;" id="holidayList">
                                    <center></center><br>
                                    <thead class="thead"  >
                                        <tr style="font-size: large; " >
                                            <th>Sl No.</th>
                                            <th>NAME</th>
                                            <th>START DATE</th>
                                            <th>END DATE</th>
                                            <th>ACTION</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        {% for i in events %}
                                        <tr style="font-size: large;">
                                            <td>{{i.id}}</td>
                                            <td style="text-transform: capitalize;">{{i.holiday_name}}</td>
                                            <td>{{i.start_date}}</td>
                                            <td>{{i.end_date}}</td>
                                            <td ></td>
                                        </tr>
                                        {% endfor %}
                                    </tbody>
                                </table>
                            </div>
                            
                        </div>
                        
                        
                    </div>
                
                </div>
                
            </div>
        </div>
    </div>




    <script>
        document.addEventListener('DOMContentLoaded', function() {
            var calendarEl = document.getElementById('calendar');

            var calendar = new FullCalendar.Calendar(calendarEl, {
            initialView: 'dayGridMonth',
            headerToolbar: {
                left: 'prev,next today',
                center: 'title',
                right: 'dayGridMonth,timeGridWeek,timeGridDay'
            },
            events: [
                // Loop through events passed from Django view and format them appropriately
                {% for event in events %}
                {
                    title: '{{ event.title }}',
                    start: '{{ event.start_date|date:"Y-m-d" }}', // Format start date
                    end: '{{ event.end_date|date:"Y-m-d" }}' // Format end date if available
                }
                {% if not forloop.last %},{% endif %} // Add comma except for the last event
                {% endfor %}
            ]
            });

             // Specify the year and month you want to open the calendar to
             var yearToOpen = {{ year }};
            var monthToOpen = {{ month }}-1; // (months are 0-indexed in JavaScript)

            // Use gotoDate to open the calendar to the specified year and month
            calendar.gotoDate(new Date(yearToOpen, monthToOpen));

            
            calendar.render();
        });



        // hide or show calendar


        document.addEventListener('DOMContentLoaded', function() {
    // Get references to the links and divs
    var calendarLink = document.getElementById("calendarLink");
    var holidayListLink = document.getElementById("holidayListLink");
    var calendarDiv = document.getElementById("cal");
    var holidayListDiv = document.getElementById("cal_list");
    
    // Hide the holiday list div initially
    holidayListDiv.style.display = "none";
    
    // Add click event listeners
    calendarLink.addEventListener("click", function (event) {
        event.preventDefault(); // Prevent the default behavior of the anchor tag
        calendarDiv.style.display = "block"; // Show the calendar div
        holidayListDiv.style.display = "none"; // Hide the holiday list div

        // Optionally, add/remove classes for styling
        calendarLink.classList.add("active");
        holidayListLink.classList.remove("active");

        // Add class to the selected div
        calendarLink.style.backgroundColor = '#213b52';
        holidayListLink.style.backgroundColor = 'transparent' ;
    });

    holidayListLink.addEventListener("click", function (event) {
        event.preventDefault(); // Prevent the default behavior of the anchor tag
        calendarDiv.style.display = "none"; // Hide the calendar div
        holidayListDiv.style.display = "block"; // Show the holiday list div

        // Optionally, add/remove classes for styling
        calendarLink.classList.remove("active");
        holidayListLink.classList.add("active");

         // Add class to the selected div
        calendarLink.style.backgroundColor = 'transparent';
        holidayListLink.style.backgroundColor = '#213b52' ;
    });
});


    </script>
</body>


{% endblock %}
